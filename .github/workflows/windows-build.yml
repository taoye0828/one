name: Windows C++ Build

on:
  push:
    branches: [ main, master ]
    paths:
      - cursor.file/one.cpp\n      - .github/workflows/windows-build.yml\n  pull_request:\n    branches: [ main, master ]\n    paths:\n      - cursor.file/one.cpp\n      - .github/workflows/windows-build.yml\n  workflow_dispatch: {}\n  release:\n    types: [created]\n\njobs:\n  build:\n    name: Build EXE (MSVC)\n    runs-on: windows-latest\n    steps:\n      - name: Checkout\n        uses: actions/checkout@v4\n      - name: Setup MSVC environment\n        uses: ilammy/msvc-dev-cmd@v1\n      - name: Build (MSVC, GUI subsystem)\n        shell: cmd\n        run: cl /nologo /EHsc /O2 /DNDEBUG /DUNICODE /D_UNICODE cursor.file\\one.cpp user32.lib shell32.lib shlwapi.lib ole32.lib advapi32.lib /Fe:StartV2ChatGPT.exe /link /SUBSYSTEM:WINDOWS\n      - name: Upload artifact\n        uses: actions/upload-artifact@v4\n        with:\n          name: StartV2ChatGPT\n          path: StartV2ChatGPT.exe\n  release:\n    name: Attach EXE to GitHub Release\n    needs: build\n    if: github.event_name == release\n    runs-on: windows-latest\n    steps:\n      - name: Download artifact\n        uses: actions/download-artifact@v4\n        with:\n          name: StartV2ChatGPT\n          path: ./dist\n      - name: Upload to Release\n        uses: softprops/action-gh-release@v2\n        with:\n          files: |\n            dist/StartV2ChatGPT.exe\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n